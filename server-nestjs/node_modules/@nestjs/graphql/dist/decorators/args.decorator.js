"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const shared_utils_1 = require("@nestjs/common/utils/shared.utils");
const optional = require("optional");
require("reflect-metadata");
const gql_paramtype_enum_1 = require("../enums/gql-paramtype.enum");
const param_utils_1 = require("./param.utils");
const { Arg: TypeGqlArg, Args: TypeGqlArgs } = optional('type-graphql') || {};
function Args(propertyOrOptions, ...pipes) {
    let typeFn = undefined;
    let argOptions = {};
    let property = propertyOrOptions;
    if (propertyOrOptions && shared_utils_1.isObject(propertyOrOptions)) {
        property = propertyOrOptions.name;
        typeFn = propertyOrOptions.type;
        argOptions = {
            description: propertyOrOptions.description,
            nullable: propertyOrOptions.nullable,
            defaultValue: propertyOrOptions.defaultValue,
        };
    }
    return (target, key, index) => {
        param_utils_1.addPipesMetadata(gql_paramtype_enum_1.GqlParamtype.ARGS, property, pipes, target, key, index);
        property && shared_utils_1.isString(property)
            ? TypeGqlArg &&
                TypeGqlArg(property, typeFn, argOptions)(target, key, index)
            : TypeGqlArgs && TypeGqlArgs(typeFn)(target, key, index);
    };
}
exports.Args = Args;
